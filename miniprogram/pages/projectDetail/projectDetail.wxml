<!-- pages/projectDetail/projectDetail.wxml -->
<view class="container">
  <!-- 项目详情展示 -->
  <view class="project-details">
    <text class="project-name">{{project.name}}</text>
    <text class="project-description">{{project.description}}</text>
    <text class="creator-info">创建者: {{creatorUsername}}</text>
    <text class="member-count">参与人数: {{project.members.length}}</text>
  </view>

  <!-- 加入项目按钮（仅未加入且非创建者） -->
  <button wx:if="{{!isCreator && !isMember}}" class="join-btn" bindtap="joinProject">加入项目</button>

  <!-- 退出项目和删除项目按钮（仅已加入） -->
  <view class="project-actions" wx:if="{{isMember || isCreator}}">
    <button wx:if="{{isMember}}" class="small-btn exit-btn" bindtap="exitProject" data-id="{{projectId}}">退出项目</button>
    <button wx:if="{{isCreator}}" class="small-btn delete-btn" bindtap="deleteProject" data-id="{{projectId}}">删除项目</button>
  </view>

  <!-- 聊天室消息展示 -->
  <scroll-view class="chat-container" scroll-y="true">
    <block wx:for="{{messages}}" wx:key="index">
      <view class="message-item">
        <text class="message-sender">{{item.senderUsername}}:</text>
        <text class="message-content">{{item.content}}</text>
        <text class="message-timestamp">{{formatTimestamp(item.timestamp)}}</text>
      </view>
    </block>
  </scroll-view>

  <!-- 发送消息输入框 -->
  <view class="message-input-container">
    <input
      class="message-input"
      placeholder="输入消息..."
      value="{{newMessage}}"
      bindinput="handleMessageInput"
    />
    <button class="send-btn" bindtap="sendMessage">发送</button>
  </view>
</view>
